目的
提供一套固定的需求描述格式，讓流程、判斷、分支在同一頁面清楚對齊，避免遺漏細節或產生誤解，也方便後續對照程式與調整。

程式
mark_spread_arb_v2

溝通格式
以主要步驟為頂層項目，下面用縮排列出條件與對應動作。 針對每個條件要寫出「符合 vs. 不符合」各自要做什麼，必要時補充重試或警示行為。 保持動詞開頭（例如「檢查」「計算」「更新」），讓流程可直接映射到程式邏輯。

範例：平倉流程
取得持倉數據 檢查雙邊倉位數量與方向 沒異常就顯示兩側數量與方向 有異常就停止程式並通知倉位數量失衡 收到行情 檢查行情兩側任一是否過期 任一側有過期就跳過 都沒過期就繼續 檢查是否同時滿足 1. 平倉點差滿足閾值 2. 雙邊仍有倉位 3. 已平倉量未達標 有滿足就進入下單 沒滿足就跳過 算出本批數量 計算目標減倉數量/批數 與持倉數量做整理（避免下超量） 與步進做整理（對齊交易所步進，允許小於最小進場量） 開始下單離場市價單 同時送市價減倉單（reduce-only） 檢查回傳 都沒回傳就依設定重試，若仍失敗則跳過本輪並警告 任一邊回傳就更新 1. 做多數量 2. 做空數量 3. 已平倉量 進行尾差處理 判斷做多數量與做空數量是否相等 不相等就把較大側用市價減倉單減掉 收到回傳成功就繼續 沒收到回傳成功就重試到上限；若仍失敗，跳過本輪並警告 相等就跳過繼續。

為什麼這種方式好
讀者視角清楚：直接照著列表往下看，就能知道每一步要做什麼、有哪些分支，需要關注的參數是哪些。 方便對照程式：開發或 review 時，可以逐項核對邏輯是否落實，若有偏差能快速定位。 討論效率高：如果要改動流程，只需指出對應的項目；雙方都能立刻對齊上下游影響，避免溝通跳步或漏掉條件。 可維護性好：日後需求變更，可以在既有結構下增刪小項，而不用重寫整段文字，維持文件與實作同步。

注意事項
每次描述流程時都依照這個格式撰寫；分支情況要完整列出。 若新需求引入額外參數或重試機制，記得在相關步驟補充說明，以免日後對照程式時遺漏。 文件更新後請同步檢查程式邏輯，確保兩者一致。